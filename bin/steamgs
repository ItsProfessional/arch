#!/bin/bash

set -o pipefail

# TODO search name or desc
if ! VARS="$(way-displays -y -g | yq '.STATE.HEADS[0] | "DESCRIPTION=\"" + .DESCRIPTION + "\" WIDTH=" + .CURRENT.MODE.WIDTH + " HEIGHT=" + .CURRENT.MODE.HEIGHT')"; then
	exit 1
fi

eval "${VARS}"

echo "desc:   ${DESCRIPTION}"
echo "width:  ${WIDTH}"
echo "height: ${HEIGHT}"

gamescope \
	--output-width "${WIDTH}" --output-height "${HEIGHT}" \
	--nested-width "${WIDTH}" --nested-height "${HEIGHT}" \
	--fullscreen \
	--adaptive-sync \
	--steam -- steam

