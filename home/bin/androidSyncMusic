#!/bin/sh

set -e

#
# rudimentary android music sync using simple-mtpfs
# todo: trap interrupts and clean up
#

mkdir ${XDG_RUNTIME_DIR}/mtp

simple-mtpfs ${XDG_RUNTIME_DIR}/mtp

rsync -a -v --omit-dir-times --update --delete-after /net/lord/music/ ${XDG_RUNTIME_DIR}/mtp/Music/

fusermount -u ${XDG_RUNTIME_DIR}/mtp

rmdir ${XDG_RUNTIME_DIR}/mtp
